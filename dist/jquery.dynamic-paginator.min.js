/*!
 * Dynamic Paginator v1.0.1 (https://github.com/alameenlr/dynamic-paginator)
 * Copyright (c) Al-Ameen LR <alameenlr@outlook.com>
 * Licensed under MIT (https://github.com/alameenlr/dynamic-paginator/license.txt)
 */
(function($){var lrs_dynamic_paginator_instances={};$.fn.dynamicPaginator=function(options){let $t=this,makeLoadRequestParams=function(options){let kv={},cvv=options.currentViewValues;for(let k in cvv){kv[options.dpParamKeys[k]]=cvv[k]}return kv.offset=cvv.pageNo*cvv.count-cvv.count,kv},instancekey=function(length){const characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let result="";for(let i=0;i<length;i++)result+=characters.charAt(Math.floor(62*Math.random()));return"i_"+result},setInOption=function(instaceId,options){lrs_dynamic_paginator_instances[instaceId]=options},getInOption=function(instaceId){return lrs_dynamic_paginator_instances[instaceId]??!1},dpg_default_option={search:{placeholder:"Search",disabledItemPropertiesKeys:[]},colorTheme:"auto",getInfoURL:"",loadListURL:"",loadedListIsComplete:!1,itemNumberKey:"index",httpRequestHeaders:{},itemProperties:[],indexedItemPropertiesKeys:[],items:[],maxPagerNumbers:10,totalItemsCount:0,setCountsPerPage:[10,20,50,100,250,500,1e3],pushToHistory:!0,showViewingStatus:!0,currentViewValues:{pageNo:1,count:10},fromStartOnSort:!1,dpParamKeys:{pageNo:"page-no",count:"count",orderBy:"order-by",orderByIn:"order-by-in",searchIn:"search-in",searchKey:"search-key",userParams:"user-params"},clientSideSearch:!0,clientSideSearchFormat:"%{{search-key}}%",userParamListner:!0,viewTemplate:'<div class="d-flex w-100 justify-content-between py-2"><div>{{searchBox}}</div><div>{{countsPerPage}}</div></div><table class="w-100"><thead><tr>{{propertiesLabel}}</tr></thead><tbody>{{itemsList}}</tbody></table><div class="d-flex w-100 justify-content-between py-2"><div class="show-status">{{viewingStatus}}</div><div>{{paginationContent}}</div></div>',paginationBlock:{hideOnSinglePage:!0,jumpTo:!0,size:"default",template:{pageNumber:'<a href="{{url}}" class="page-number">{{pageNo}}</a>',previous:'<a href="{{url}}" class="page-previous"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M9.4 233.4a32 32 0 0 0 0 45.3l192 192a32 32 0 0 0 45.3-45.3L77.3 256 246.6 86.6a32 32 0 0 0-45.3-45.3l-192 192z" fill="currentColor"/></svg></a>',next:'<a href="{{url}}" class="page-next"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 233.4a32 32 0 0 1 0 45.3l-192 192a32 32 0 0 1-45.3-45.3L242.7 256 73.4 86.6a32 32 0 0 1 45.3-45.3l192 192z" fill="currentColor"/></svg></a>',more:'<a class="page-more">...</a>',jumpTo:'<form action="#"><div class="d-flex border jump-to-box"><input type="number" name="jump-to-page" class="lrs-dpf no-border no-outline no-bg number"><button type="submit" class="no-border no-outline no-bg">Go</button></div></form>',background:!0}},pageContentLoader:"<div class='dpg-loading'></div>",makeItemPropertyLabel:(property,isIndexed,sorted)=>isIndexed?`<th tabindex="0" role="columnheader button" data-property-key="${property.key}" class="head-sort${sorted?" "+sorted:""}"${sorted?' title=" Sort '+("asc"==sorted?"descending":"ascending")+'"':""}>${property.label}</th>`:`<th data-property-key="${property.key}">${property.label}</th>`,makeItem:(item,itemProperties,searchedIndex,searchedKey)=>{let escapeQuotes=str=>str?.toString().replace(/[\"]/gm,"&quot;").replace(/[\']/gm,"&apos;");return"<tr>"+itemProperties.map((p=>searchedIndex==p.key?`<td data-key="${p.key}" data-value="${escapeQuotes(item[p.key])}">${(content=>{let matchRex=new RegExp("("+searchedKey.replace(/[\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")","gui");return content.toString().replace(matchRex,"<span class='search-match'>$1</span>")})(item[p.key])}</td>`:`<td data-key="${p.key}" data-value="${escapeQuotes(item[p.key])}">${item[p.key]}</td>`)).join("")+"</tr>"},makeViewingStatus:(pageno,countsPerPage,totalItemsCount)=>{if(0==totalItemsCount)return"0 entries";let to=pageno*countsPerPage;return`Showing ${to-countsPerPage+1} to ${to>totalItemsCount?totalItemsCount:to} of ${totalItemsCount} entries`},makeSearchBox:options=>{if(0!=options.search){let search_op=options.search,search_sel="";return options.itemProperties.forEach((p=>{search_sel+=options.indexedItemPropertiesKeys.indexOf(p.key)>-1&&options.search.disabledItemPropertiesKeys.indexOf(p.key)<0?`<option value="${p.key}" ${options.currentViewValues.searchIn==p.key?" selected":""}>${p.label}</option>`:""})),'<form action="#"><div class="d-flex border search-box">'+(search_sel.length>0?`<select name="${options.dpParamKeys.searchIn}" class="no-border no-outline no-bg">`+search_sel+"</select>":"")+`<input type="text" name="${options.dpParamKeys.searchKey}" placeholder="${search_op.placeholder}" class="lrs-dpf no-border no-outline no-bg" value="${options.currentViewValues.searchKey??""}"><button type="submit" class="no-border no-outline no-bg"><svg width="18" height="14" style="fill:currentColor;opacity:0.3;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M416 208c0 45.9-14.9 88.3-40 122.7l126.6 126.7c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0s208 93.1 208 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg></button></div></form>`}return""},makeCountSelection:function(fieldname,countsPerPage,totalItemsCount,countSelect){let search_sel="";return countSelect.forEach((n=>{search_sel+=`<option value="${n}" ${n==countsPerPage?" selected":""}>${n}</option>`})),`<div class="set-view-count"><select name="${fieldname}" class="lrs-dpf border no-bg no-outline">`+search_sel+"</select><span> Items per page.</span></div>"}},currentViewValueKeys=["pageNo","count","orderBy","orderByIn","searchIn","searchKey","userParams"],DPFNS={getLRSDPGElement:function(name,$e){return $e.find('[data-lrs-dpg-elm="'+name+'"]')},setUserParamsInElement($e,options){for(let k in options.currentViewValues.userParams)$e.find('.dynamic-paginator-input[name="'+k+'"]').val(options.currentViewValues.userParams[k])},functionNametoFunction:function(option){for(let k in option)if(["makeItemPropertyLabel","makeItem","makeViewingStatus","makeSearchBox","makeCountSelection"].indexOf(k)>-1&&"string"==typeof option[k])try{let evalue=eval(option[k]);if(!evalue)throw option[k]+":is not defined.";option[k]=evalue}catch(e){console.error(e)}return option},generateSortImageURL:function(sort,themeisDark){let svg={pt:"",o:"1",c:"#333333"};return themeisDark&&(svg.c="#d4d4d4"),0==sort?(svg.pt="M4.4 9.8h15.2c.3 0 .6 0 .8-.3.2-.2.3-.5.3-.8s0-.5-.3-.7L12.8.3c-.3-.2-.5-.3-.8-.3s-.5.1-.8.3L3.6 8a1 1 0 0 0-.3.7c0 .3 0 .6.3.8.2.2.5.3.8.3zm15.2 4.4H4.4a1 1 0 0 0-.8.3c-.2.2-.3.5-.3.8s0 .5.3.7l7.6 7.7c.3.2.5.3.8.3s.5-.1.8-.3l7.6-7.7c.2-.2.3-.4.3-.7s0-.6-.3-.8a1 1 0 0 0-.8-.3z",svg.o="0.3"):"asc"==sort?svg.pt="M4.4 17h15.2c.3 0 .6-.2.8-.4.2-.2.3-.5.3-.8a1 1 0 0 0-.3-.8l-7.6-7.6c-.3-.2-.5-.3-.8-.3s-.5.1-.8.3l-7.6 7.7a1 1 0 0 0-.3.7c0 .3 0 .6.3.8.2.2.5.3.8.3z":"desc"==sort&&(svg.pt="M19.6 7H4.4a1 1 0 0 0-.8.4c-.2.2-.3.5-.3.8s0 .5.3.8l7.6 7.6c.3.2.5.3.8.3s.5-.1.8-.3l7.6-7.7c.2-.2.3-.4.3-.7s0-.6-.3-.8a1 1 0 0 0-.8-.3z"),""!=svg.pt?'url("data:image/svg+xml,'+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" xml:space="preserve"><path fill="${svg.c}" fill-opacity="${svg.o}" d="${svg.pt}"/></svg>`)+'")':"none"},contentLoader:function($e,options,show){let _ls=DPFNS.getLRSDPGElement("items-list",$e);if(show){if(0==_ls.parent().find(".lrs-dpg-content-loader").length){let loader=document.createElement("div");loader.innerHTML=options.pageContentLoader;let h=_ls.height();loader.style.height=h+"px",loader.style.width=_ls.width()+"px",0==h&&_ls.addClass("null-loader"),loader.classList.add("lrs-dpg-content-loader"),_ls.prepend(loader)}}else _ls.removeClass("null-loader"),$.each(_ls.parent().find(".lrs-dpg-content-loader"),(function(){this.remove()}))},upadateViewingStatus:function($e,options,pageNo=options.currentViewValues.pageNo,count=options.currentViewValues.count,total=options.totalItemsCount){DPFNS.getLRSDPGElement("viewing-status",$e).html(options.makeViewingStatus(pageNo,count,total))},urlParamsToCurrentViewPageValues:function(gets,options){let kv=options.currentViewValues;for(let k of currentViewValueKeys){let tmp=options.dpParamKeys[k];if(gets[tmp])if("userParams"==k){let keyVal=atob(gets[tmp]);keyVal=JSON.parse(keyVal),kv[k]=keyVal}else{let getType=typeof options.currentViewValues[k];kv[k]="number"==getType?parseInt(gets[tmp])??0:gets[tmp]}}return kv},setOptionFromVars:function(options){if(options.currentViewValues.count=options.currentViewValues.count??DefaultOptions.dpdefaultOption.currentViewValues.count,options.pushToHistory){let url=DPGURLS.splitURLToParams();options.currentViewValues=DPFNS.urlParamsToCurrentViewPageValues(url.gets,options)}return options},makeSearchRegEx:function(key,rexFormat="{{search-key}}%"){return key=key.replace(/\%/gi,"!%"),rexFormat=(rexFormat=rexFormat.replace(/\{\{search-key\}\}/gm,key)).replace(/[\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),rexFormat=/^%/.test(rexFormat)?rexFormat.replace(/^%/,".*"):"^"+rexFormat,/([^\!]%)$/.test(rexFormat)&&(rexFormat=rexFormat.replace(/%$/,".*")),rexFormat=rexFormat.replace(/\!\%/gm,"%"),new RegExp(rexFormat,"giu")},jsTableSearch:function($e,options){let cvv=options.currentViewValues,e_Sel='[data-lrs-dpg-elm="items-list"]',listParent=$e.find(e_Sel),listItems=$e.find(e_Sel+">*");if(cvv.searchKey){let searchIn=options.currentViewValues.searchIn??options.itemProperties[0].key,getVal=e=>e?.getAttribute("data-value")??e?.textContent??"",d_Key='[data-key="'+searchIn+'"]',searchRex=(document.createElement(listParent[0]?.tagName??"div"),DPFNS.makeSearchRegEx(cvv.searchKey??"",options.clientSideSearchFormat)),matchRex=new RegExp("("+cvv.searchKey.replace(/[\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")","gui"),count=0;$.each(listItems,(function(i,e){e.style.removeProperty("display"),e?.querySelectorAll(".search-match").forEach((el=>{el.insertAdjacentHTML("beforebegin",el.innerHTML),el.remove()}));let _v=e.querySelector(d_Key);getVal(_v).match(searchRex)?(e?.querySelectorAll('[data-key="'+searchIn+'"]').forEach((ve=>{ve.innerHTML=getVal(ve)?.replace(matchRex,"<span class='search-match'>$1</span>")})),count++):e.style.display="none"})),triggerEvents.eventPageLoaded($e,options),DPFNS.upadateViewingStatus($e,options,1,count,count)}else $.each(listItems,(function(i,e){e?.querySelectorAll(".search-match").forEach((el=>{el.insertAdjacentHTML("beforebegin",el.innerHTML),el.remove()})),e.style.removeProperty("display")})),DPFNS.upadateViewingStatus($e,options)},sortTable:function($e,options){let isInt=!0,e_Sel='[data-lrs-dpg-elm="items-list"]',d_Key='[data-key="'+options.currentViewValues.orderBy+'"]',listParent=$e.find(e_Sel),listItems=$e.find(e_Sel+">*"),_nel=document.createElement(listParent[0]?.tagName??"div"),key_vals=[];$.each(listItems,(function(i,e){let _v=$(e).find(d_Key),v=_v.attr("data-value")??_v.text()??"";v.match(/[0-9\.]{1,15}/)||(isInt=!1),v=isInt&&!isNaN(parseFloat(v))?parseFloat(v):v.toLowerCase(),key_vals.push({p:i,v:v})}));var arr,order;arr=key_vals,order=options.currentViewValues.orderByIn??"asc",key_vals="desc"==order?arr.sort(((x,y)=>x.v>y.v?-1:x.v<y.v?1:0)):arr.sort(((x,y)=>x.v<y.v?-1:x.v>y.v?1:0)),key_vals.forEach((v=>{_nel.appendChild(listItems[v.p])})),listParent.html(_nel.innerHTML),_nel.remove(),listParent.attr("data-sorted-on",options.currentViewValues.orderBy??"")}},DPGURLS={splitURLToParams:function(url){let ret={ref:"",gets:{}};url=url||window.location.href;let parts=(url=decodeURIComponent(url)).split("?"),gets=parts.length>1?parts.pop():"";function parseFinalValue(value){if(Boolean(value)&&"object"==typeof value&&!Array.isArray(value))return keysSorter(value);{let p=parseFloat(value);return isNaN(p)?value:p%1==0?Math.floor(p):p}}if(ret.ref=parts[0],""!=gets){let result={};gets=gets.replaceAll("+"," ");let gb=gets.split("&");for(var i=0;i<gb.length;i++){let gv=gb[i].split("="),key=gv[0],[obcheck,key_sec]=key.split("[",2);if(key_sec){keyParts.unshift(obcheck);var last=keyParts.pop();keyParts.reduce(((o,k)=>o[k]=o[k]||{}),result)[last]=parseFinalValue(value)}else result[key]=parseFinalValue(gv[1])}ret.gets=result}return ret},currentViewPageValuesToURLParams:function(options){let kv={},cvv=options.currentViewValues;for(let k in cvv){let tmp=options.dpParamKeys[k];if("userParams"==k){let keyVal=cvv[k];keyVal=JSON.stringify(keyVal),keyVal=btoa(keyVal),kv[tmp]=keyVal}else kv[tmp]=cvv[k]}return kv},makeURLFromParams:function(uparms){let ret=uparms.ref,gets=function(object){if(!object)return"";let strings=function stringifyObject(object,options,parentKey=!1){const objectCopy={};for(const[key,value]of Object.entries(object))objectCopy[key]=value;return Object.keys(objectCopy).map((key=>{const value=object[key];if(parentKey&&(key=parentKey+"["+key+"]"),void 0===value)return"";if(null===value)return encode(key,options);if("object"==typeof value){if(Array.isArray(value))return 0===value.length&&"bracket-separator"===options.arrayFormat?encode(key,options)+"[]":value.reduce(formatter(key),[]).join("&");return stringifyObject(value,options,key).join("&")}return encodeURIComponent(key)+"="+encodeURIComponent(value)}))}(object);return strings.join("&")}(uparms.gets);return ret+(gets.length>0?"?"+gets:"")}},triggerEvents={eventPageLoaded:function(element,options){element.trigger("page-loaded",[options.currentViewValues])},eventNextClick:function(element,options){element.trigger("next-click",[options.currentViewValues])},eventPreviousClick:function(element,options){element.trigger("prev-click",[options.currentViewValues])},eventCountChanged:function(element,options){element.trigger("count-change",[options.currentViewValues])},eventSorted:function(element,options){element.trigger("sorted",[options.currentViewValues])}},calcTotalPages=function(options){let n=Math.ceil(options.totalItemsCount/options.currentViewValues.count);return 0==n?1:n},preventDefaultATag=function($a){$a.on("click",(function(e){e.preventDefault()}))},loadPageAfterUpdateView=function($el,options,onHistoryPoppingLoad=!1){let pgElem=DPFNS.getLRSDPGElement("pagination",$el).find(".page-nav");if(options.pushToHistory&&!onHistoryPoppingLoad){let url=DPGURLS.splitURLToParams(),cvv={};$.extend(!0,cvv,url.gets,DPGURLS.currentViewPageValuesToURLParams(options)),url.gets=cvv;let newUrl=DPGURLS.makeURLFromParams(url);history.pushState({state:newUrl},"null",newUrl)}DPFNS.setUserParamsInElement($el,options),pgElem.html(paginationSection.paginationComponent(options)),paginationSection.setJumpToComponentView($el,options),addEventsToButtons($el,instaceId),loadPage(instaceId,$el,options)},addNumberButtonEvent=function($e,options,$pnb){$pnb.on("click",(function(){options.currentViewValues.pageNo=parseInt($(this).closest(".number").attr("data-page-number")),setInOption(instaceId,options),loadPageAfterUpdateView($e,options)}))},addMoreButtonEvent=function($e,options,$pnm){let totalPages=calcTotalPages(options);$pnm.on("click",(function(){let $t=$(this),currentPage=options.currentViewValues.pageNo,_tmr=$t.closest(".number"),_pr=_tmr.parent(),_prev=_tmr.prev(),prev=parseInt(_prev.attr("data-page-number")??""),_next=_tmr.next(),next=parseInt(_next.attr("data-page-number")??""),_cpage=$t.closest(".pagination").find('[data-page-number="'+currentPage+'"]'),side="",count=0;if(prev>=1&&next<=currentPage){side="L";let _pcp=_cpage.next();if(_pcp.length>0){let k=prev;for(;_pcp.length;){if(_pcp.attr("data-page-number")==totalPages||k+1==next)break;_pcp.remove(),_pcp=_cpage.next(),count++,k++}}else{_pcp=_next;let k=prev;for(;_pcp.length;){if(_pcp.attr("data-page-number")==totalPages||k+1==next)break;_pcp=_pcp.next(),_pcp.prev().remove(),count++,k++}}}else if(prev==currentPage&&next!=prev+1){side="L";let _pcp=_next,k=prev;for(;_pcp.length;){if(_pcp.attr("data-page-number")==totalPages||k+1==next)break;_pcp=_pcp.next(),_pcp.prev().remove(),count++,k++}}else if(prev>=currentPage&&next>=totalPages){side="R";let _pcp=_cpage.prev(),k=prev;for(;_pcp.length;){if(1==_pcp.attr("data-page-number")||k+1==next)break;_pcp.remove(),_pcp=_cpage.prev(),count++,k++}}if(count<next-prev){let _pcp=_prev.prev();for(;_pcp.length;){let pn=_pcp.attr("data-page-number");if(1==pn||pn==currentPage||count==next-prev)break;_pcp.remove(),_pcp=_prev.prev(),count++}}if(count<next-prev){let _pcp=_next.next();for(;_pcp.lengt;){let pn=_pcp.attr("data-page-number");if(pn==totalPages||pn==currentPage||count==next-prev)break;_pcp.remove(),_pcp=_next.next(),count++}}let nbt=[];for(;count>0&&prev<next;)nbt.push(paginationSection.makePagerLI(++prev,options)),count--;_tmr[0]?.insertAdjacentHTML("beforebegin",nbt.join("")),_tmr[0]?.remove();let pages=[],previous="0";$.each(_pr.find(".number"),(function(i,p){let _p=$(p),pn=_p.attr("data-page-number");if(previous==pn)_p.remove();else{let pnn=parseInt(pn);if(isNaN(pnn))_p.remove();else{let prn=parseInt(previous);prn+1!==pnn&&_p[0]?.insertAdjacentHTML("beforebegin",paginationSection.makePagerLI(prn+2==pnn?prn+1:"...",options))}pages.push(pnn)}previous=pn??""}));let ii=0;for(;_pr.find(".number").length>options.maxPagerNumbers&&($.each(_pr.find(".number"),(function(i,p){let _p=$(p);if("..."==_p.attr("data-page-number")){let _k=_p.prev(),pn=_k.attr("data-page-number");1!=pn&&pn!=currentPage&&pn!=totalPages&&_k.remove()}})),!(++ii>10)););previous="0",$.each(_pr.find(".number"),(function(i,p){let _p=$(p),pn=_p.attr("data-page-number");"..."==previous&&"..."==pn&&_p.remove(),previous=pn??""})),addEventsToButtons($e,instaceId)}))},addEventsToButtons=function($e,instaceId){let options=getInOption(instaceId),totalPages=calcTotalPages(options),pgSect=DPFNS.getLRSDPGElement("pagination",$e),pgElem=pgSect.find(".page-nav"),next=pgElem.find(".page-next"),previous=pgElem.find(".page-previous"),jumpTo=pgSect.find('.jump-to form [name="jump-to-page"]');next[0]?.toggleAttribute("disabled",options.currentViewValues.pageNo==totalPages),previous[0]?.toggleAttribute("disabled",1==options.currentViewValues.pageNo),jumpTo.length>0&&jumpTo.val(options.currentViewValues.pageNo.toString()),next.on("click",(function(){this.hasAttribute("disabled")||(options.currentViewValues.pageNo++,setInOption(instaceId,options),loadPageAfterUpdateView($e,options),triggerEvents.eventNextClick($e,options))})),previous.on("click",(function(){this.hasAttribute("disabled")||(options.currentViewValues.pageNo--,setInOption(instaceId,options),loadPageAfterUpdateView($e,options),triggerEvents.eventPreviousClick($e,options))})),$.each(pgElem.find("a"),(function(){preventDefaultATag($(this))})),$.each(pgElem.find(".pager .number.pageno>*"),(function(){addNumberButtonEvent($e,options,$(this))})),$.each(pgElem.find(".pager .number.loadmore>*"),(function(){addMoreButtonEvent($e,options,$(this))}))},addeventListners=function(instaceId,$e,options){let searchBox=DPFNS.getLRSDPGElement("search-box",$e),count=DPFNS.getLRSDPGElement("count-select",$e),sortSel=DPFNS.getLRSDPGElement("property-head",$e);$e.find("form").on("submit",(function(e){e.preventDefault()})),searchBox.find("form:not(.e-plus)").addClass("e-plus").on("submit",(async function(e){let options=getInOption(instaceId),_thf=e.target,_search_in=_thf?.querySelector('[name="'+options.dpParamKeys.searchIn+'"]'),_search_key=_thf?.querySelector('[name="'+options.dpParamKeys.searchKey+'"]'),searchIn=_search_in.value,searchKey=_search_key.value,doJsSearch=!1,previousSearchKey=options.currentViewValues.searchKey??"",previousSearchIn=options.currentViewValues.searchIn;options.clientSideSearch&&(!previousSearchIn||previousSearchIn==searchIn)&&searchKey.length>=previousSearchKey.length&&0==searchKey.indexOf(previousSearchKey)&&options.totalItemsCount<=options.currentViewValues.count&&(doJsSearch=!0),0==searchKey.length?(options.currentViewValues.searchIn=void 0,options.currentViewValues.searchKey=void 0,doJsSearch=!1):(options.currentViewValues.searchIn=searchIn,options.currentViewValues.searchKey=searchKey),setInOption(instaceId,options);let reqLoad=!1;if(doJsSearch)DPFNS.jsTableSearch($e,options);else if(options.loadedListIsComplete){options.currentViewValues.pageNo=1;let el=DPFNS.getLRSDPGElement("list-data",$e),cvv=options.currentViewValues;if(el.length>0){let uparams=JSON.parse(el.attr("data-user-params"));Object.keys(uparams).forEach((k=>{cvv.userParams[k]==uparams[k]||(reqLoad=!0)})),0==reqLoad&&loadPageAfterUpdateView($e,options)}}else reqLoad=!0;reqLoad&&(DPFNS.contentLoader($e,options,!0),$.ajax({url:options.getInfoURL,headers:options.httpRequestHeaders,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:makeLoadRequestParams(options),dataType:"json",success:function(resp){options.totalItemsCount=resp.totalItemsCount??0,options.currentViewValues.pageNo=1,$.extend(!0,options,resp),options=DPFNS.functionNametoFunction(options),setInOption(instaceId,options),loadPageAfterUpdateView($e,options)},error:function(e){console.log("Unable to fetch the data from getInfoURL:"+options.getInfoURL)}}))})),searchBox.find('form [name="'+options.dpParamKeys.searchKey+'"]:not(.e-plus)').addClass("e-plus").on("input",(function(e){if(0==this.value.length){let options=getInOption(instaceId);options.currentViewValues.searchIn=void 0,options.currentViewValues.searchKey=void 0,setInOption(instaceId,options),$(this).closest("form").submit()}})),$e.find(".jump-to form:not(.e-plus)").addClass("e-plus").on("submit",(function(){let options=getInOption(instaceId),totalPages=calcTotalPages(options),_no=$(this).find('[name="jump-to-page"]'),no=parseInt(_no.val());no=isNaN(no)||no<1?1:no>totalPages?totalPages:no,_no.val(no.toString()),options.currentViewValues.pageNo=no,setInOption(instaceId,options),loadPageAfterUpdateView($e,options)})),count.find('[name="count"]:not(.e-plus)').addClass("e-plus").on("change",(function(e){let options=getInOption(instaceId);options.currentViewValues.count=parseInt($(this).val());let totalPages=calcTotalPages(options);options.currentViewValues.pageNo>totalPages&&(options.currentViewValues.pageNo=totalPages),triggerEvents.eventCountChanged($e,options),setInOption(instaceId,options),loadPageAfterUpdateView($e,options)})),$.each(sortSel.find(".head-sort:not(.e-plus)"),(function(){$(this).addClass("e-plus"),$(this).on("click",(function(){let $t=$(this),pk="data-property-key",key=this.hasAttribute(pk)?$t.attr(pk)??"":$t.find("["+pk+"]")?.attr(pk)??"",order=options.currentViewValues.orderByIn;order="asc"==order?"desc":"asc",options.currentViewValues.orderBy!=key&&(order="asc"),options.currentViewValues.orderByIn=order,options.currentViewValues.orderBy=key,setInOption(instaceId,options),$t.addClass(order),$t.removeClass("asc"==order?"desc":"asc"),$.each($t.siblings(),(function(){$(this).removeClass("desc asc")})),options.totalItemsCount<=options.currentViewValues.count?(DPFNS.sortTable($e,options),triggerEvents.eventSorted($e,options)):(options.fromStartOnSort&&(options.currentViewValues.pageNo=1,setInOption(instaceId,options)),options.triggerEventSorted=!0,loadPageAfterUpdateView($e,options))}))})),$e.find(".dynamic-paginator-input:not(.e-plus)").addClass("e-plus").on("input",(function(){let options=getInOption(instaceId),$t=$(this);options.currentViewValues.userParams||(options.currentViewValues.userParams={}),options.currentViewValues.userParams[$t.attr("name")]=$t.val(),setInOption(instaceId,options),options.userParamListner&&loadPageAfterUpdateView($e,options)})),addEventsToButtons($e,instaceId);let cr_link_search=document?.location?.search;window?.addEventListener("popstate",(function(ev){let options=getInOption(instaceId);ev.preventDefault(),cr_link_search!==document?.location?.search&&(cr_link_search=document?.location?.search,options=DPFNS.setOptionFromVars(options),setInOption(instaceId,options),loadPageAfterUpdateView($e,options,!0))})),"auto"==options.colorTheme&&window?.matchMedia("(prefers-color-scheme: dark)")?.addEventListener("change",(event=>{$t.toggleClass("theme-dark",!!event.matches)}))},loadPage=function(instaceId,$e,options){let _ls=DPFNS.getLRSDPGElement("items-list",$e),load=!0;if(""!=options.loadListURL){if(options.loadedListIsComplete){let el=DPFNS.getLRSDPGElement("list-data",$e);if(el.length>0){load=!1;let cvv=options.currentViewValues,data=JSON.parse(el.text()),uparams=JSON.parse(el.attr("data-user-params"));if(Object.keys(uparams).forEach((k=>{cvv.userParams[k]!=uparams[k]&&(load=!0)})),0==load){let sortOrder=cvv.orderByIn??"asc",sortKey=cvv.orderBy;if("desc"==sortOrder?data.sort(((x,y)=>x[sortKey]>y[sortKey]?-1:x[sortKey]<y[sortKey]?1:0)):data.sort(((x,y)=>x[sortKey]<y[sortKey]?-1:x[sortKey]>y[sortKey]?1:0)),cvv.searchKey){let searchIn=cvv.searchIn??options.itemProperties[0].key,searchRex=DPFNS.makeSearchRegEx(cvv.searchKey??"",options.clientSideSearchFormat);data=data.filter((d=>!!d[searchIn].match(searchRex)))}options.totalItemsCount=data.length;let resp=data.slice((cvv.pageNo-1)*cvv.count,cvv.pageNo*cvv.count);_ls.html(resp.map(((e,i)=>(!1!==options.itemNumberKey&&(e[options.itemNumberKey]=(cvv.pageNo-1)*cvv.count+i),options.makeItem(e,options.itemProperties,cvv.searchIn??"",cvv.searchKey??"")))).join("")),options.triggerEventSorted&&(options.triggerEventSorted=void 0,triggerEvents.eventSorted($e,options)),DPFNS.upadateViewingStatus($e,options),triggerEvents.eventPageLoaded($e,options),DPFNS.getLRSDPGElement("pagination",$e).find(".page-nav").html(paginationSection.paginationComponent(options)),paginationSection.setJumpToComponentView($e,options),addEventsToButtons($e,instaceId)}}}load&&(options.totalItemsCount>0?(DPFNS.contentLoader($e,options,!0),$.ajax({url:options.loadListURL,headers:options.httpRequestHeaders,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:makeLoadRequestParams(options),dataType:"json",success:function(resp){DPFNS.contentLoader($e,options,!1);try{if(!Array.isArray(resp))throw"Response is not an array Object";if(options.loadedListIsComplete){let el=DPFNS.getLRSDPGElement("list-data",$e);return 0==el.length&&(el=$('<div style="display:none;" data-lrs-dpg-elm="list-data"></div>'),$e.append(el)),el.text(JSON.stringify(resp)),el.attr("data-user-params",JSON.stringify(options.currentViewValues.userParams)),void loadPage(instaceId,$e,options)}_ls.html(resp.map(((e,i)=>(!1!==options.itemNumberKey&&(e[options.itemNumberKey]=(options.currentViewValues.pageNo-1)*options.currentViewValues.count+i),options.makeItem(e,options.itemProperties,options.currentViewValues.searchIn??"",options.currentViewValues.searchKey??"")))).join("")),options.triggerEventSorted&&(options.triggerEventSorted=void 0,triggerEvents.eventSorted($e,options)),DPFNS.upadateViewingStatus($e,options),triggerEvents.eventPageLoaded($e,options)}catch(e){console.error("Unable to fetch the data from loadListURL:"+options.loadListURL,e),console.log("Response Must be in Array.")}},error:function(e){console.log("Unable to fetch the data from getInfoURL:"+options.getInfoURL)}})):(DPFNS.upadateViewingStatus($e,options),DPFNS.contentLoader($e,options,!1),triggerEvents.eventPageLoaded($e,options),_ls.html("")))}else console.error("loadListURL is Empty.",options.loadListURL)},paginationSection={makeMakeBt:function(template,pageNo,options,addUrl=!0){let btUrl="#";if(-1==pageNo&&(addUrl=!1),addUrl){let url=DPGURLS.splitURLToParams(),cvp=DPGURLS.currentViewPageValuesToURLParams(options);cvp[options.dpParamKeys.pageNo]=pageNo;for(let k in cvp)url.gets[k]=cvp[k];url.gets[options.dpParamKeys.pageNo]=pageNo,btUrl=DPGURLS.makeURLFromParams(url)}let content=template.replace(/\{\{url\}\}/gm,btUrl);if(content=content.replace(/\{\{pageNo\}\}/gm,pageNo.toString()),pageNo==options.currentViewValues.pageNo){let _d=document.createElement("div");_d.innerHTML=content,_d.firstElementChild?.classList.add("active"),content=_d.innerHTML}return content},makePagerLI:function(pn,options,addClass=""){let pgb=options.paginationBlock;return`<li class="number ${("..."==pn?"loadmore":"pageno")+" "+addClass}" data-page-number="${pn}">`+("..."==pn?this.makeMakeBt(pgb.template.more,-1,options,!1):this.makeMakeBt(pgb.template.pageNumber,pn,options))+"</li>"},generatePageNumbers:function(totalPages,currentPage,maxItems){let nums=[],left=[],right=[],delta=Math.floor(maxItems/2)-2,i=0,k=0;for(i=currentPage-1;i>1&&k<delta;i--,k++)left.unshift(i);for(i=currentPage+1,k=0;i<totalPages&&k<delta;i++,k++)right.push(i);let delta_fill=2*delta-right.length-left.length;if(delta_fill>0)if(right.length<delta)for(i=left[0]-1,k=0;i>1&&k<delta_fill;i--,k++)left.unshift(i);else if(left.length<delta)for(i=right[right.length-1]+1,k=0;i<totalPages&&k<delta_fill;i++,k++)right.push(i);if(nums=1==currentPage||currentPage==totalPages?left.concat(right):left.concat([currentPage],right),1==currentPage&&nums.length>0){let t1=nums[nums.length-1]+1;totalPages!=t1&&nums.push(t1)}else if(currentPage==totalPages&&nums.length>0){let t1=nums[0]-1;1!=t1&&nums.unshift(t1)}nums[0]-1>=2?(totalPages-nums[nums.length-1]>=2&&nums.shift(),nums.unshift("...")):nums[0]-1>1&&nums.unshift(nums[0]-1),nums.unshift(1);let nli=nums.length-1;return totalPages-nums[nli]>=2?nums.push("..."):totalPages-nums[nli]>1&&nums.push(nums[nli]+1),totalPages>1&&nums.push(totalPages),nums},setJumpToComponentView:function($e,options){let pgSec=DPFNS.getLRSDPGElement("pagination",$e),show=1==calcTotalPages(options)&&1==options.paginationBlock.hideOnSinglePage;pgSec.find(".jump-to").toggleClass("d-none",show)},jumpToComponent:options=>1==calcTotalPages(options)&&1==options.paginationBlock.hideOnSinglePage?"":options.paginationBlock.jumpTo?'<div class="jump-to">'+options.paginationBlock.template.jumpTo+"</div>":"",paginationComponent(options){let pgb=options.paginationBlock,totalPages=calcTotalPages(options);if(1==totalPages&&1==pgb.hideOnSinglePage)return"";let currentPage=options.currentViewValues.pageNo,maxItems=options.maxPagerNumbers,pnumbers=paginationSection.generatePageNumbers(totalPages,currentPage,maxItems),previous=paginationSection.makeMakeBt(pgb.template.previous,1==currentPage?-1:currentPage-1,options),next=paginationSection.makeMakeBt(pgb.template.next,currentPage==totalPages?-1:currentPage+1,options),pager='<ul class="pager">'+pnumbers.map((pn=>paginationSection.makePagerLI(pn,options))).join("")+"</ul>";return`<div class="pagination${0==options.paginationBlock.template.background?" dpg-no-bg":""}">`+previous+pager+next+"</div>"}},intiatePaginator=function(instanceid,$e,options=!1){$e.addClass("lrs-dynamic-paginator");let content=(options=0==options?getInOption(instanceid):options).viewTemplate??"";if(("auto"==options.colorTheme&&window?.matchMedia&&window?.matchMedia("(prefers-color-scheme: dark)").matches||"dark"==options.colorTheme)&&$e.addClass("theme-dark"),content=content.replace(/(\>)\{\{propertiesLabel\}\}(\<)/gm," data-lrs-dpg-elm='property-head'$1"+options.itemProperties.map((p=>options.makeItemPropertyLabel(p,options.indexedItemPropertiesKeys.indexOf(p.key)>-1,options.currentViewValues?.orderBy==p.key&&options.currentViewValues?.orderByIn))).join("")+"$2"),content=content.replace(/(\>)\{\{itemsList\}\}(\<)/gm," data-lrs-dpg-elm='items-list'$1$2"),content=content.replace(/(\>)\{\{viewingStatus\}\}(\<)/gm," data-lrs-dpg-elm='viewing-status'$1$2"),content=content.replace(/(\>)\{\{searchBox\}\}(\<)/gm," data-lrs-dpg-elm='search-box'$1"+options.makeSearchBox(options)+"$2"),0!=options.setCountsPerPage){let counts=options.setCountsPerPage;content=content.replace(/(\>)\{\{countsPerPage\}\}(\<)/gm," data-lrs-dpg-elm='count-select'$1"+options.makeCountSelection(options.dpParamKeys.count,options.currentViewValues.count,options.totalItemsCount,counts)+"$2")}content=content.replace(/(\>)\{\{paginationContent\}\}(\<)/gm," data-lrs-dpg-elm='pagination'$1<div class='d-flex'><div class='page-nav'>"+paginationSection.paginationComponent(options)+"</div>"+paginationSection.jumpToComponent(options)+"$2"),$e.html(content),$e.prepend("<style>"+['.lrs-dynamic-paginator.theme-dark [data-lrs-dpg-elm="property-head"]','.lrs-dynamic-paginator [data-lrs-dpg-elm="property-head"]'].map(((b,i)=>[!1,"asc","desc"].map((c=>b+" .head-sort"+(0==c?"":"."+c)+"{background-image:"+DPFNS.generateSortImageURL(c,0==i)+"}")).join(""))).join("")+"</style>"),options.currentViewValues.userParams&&DPFNS.setUserParamsInElement($e,options),$.each($e.find(".dynamic-paginator-input[name]"),(function(i,e){let k=e.name,v=e.value;options.currentViewValues.userParams=options.currentViewValues?.userParams??{},options.currentViewValues.userParams[k]=v})),setInOption(instaceId,options),loadPage(instaceId,$e,options),addeventListners(instaceId,$e,options)},newOption={},instaceId=instancekey(15);$.extend(!0,newOption,dpg_default_option,options),$t.attr("data-lrsdpg-instance",instaceId),newOption=DPFNS.setOptionFromVars(newOption);let freshLoad=function(instaceId,options){""==options.getInfoURL?(options=DPFNS.functionNametoFunction(options),setInOption(instaceId,$t,options),intiatePaginator(instaceId,$t,options)):$.ajax({url:options.getInfoURL,headers:options.httpRequestHeaders,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:makeLoadRequestParams(options),dataType:"json",success:function(resp){$.extend(!0,options,resp),options=DPFNS.functionNametoFunction(options),options=DPFNS.setOptionFromVars(options),setInOption(instaceId,options),intiatePaginator(instaceId,$t,options)},error:function(e){console.log("Unable to fetch the data from getInfoURL:"+options.getInfoURL)}})};return freshLoad(instaceId,newOption),this.refresh=function(){let newOption=getInOption(instaceId);return freshLoad(instaceId,newOption),this},this.setViewValues=function(pageNo,count,orderBy,orderByIn,searchIn,searchKey){let newOption=getInOption(instaceId);return(pageNo=parseInt(pageNo))>0&&(newOption.currentViewValues.pageNo=pageNo),(count=parseInt(count))>0&&(newOption.currentViewValues.count=count),"string"==typeof orderBy&&(newOption.currentViewValues.orderBy=orderBy),"asc"!=orderByIn&&"desc"!=orderByIn||(newOption.currentViewValues.orderByIn=orderByIn),"string"==typeof searchIn&&(newOption.currentViewValues.searchIn=searchIn),"string"==typeof searchKey&&(newOption.currentViewValues.searchKey=searchKey),setInOption(instaceId,newOption),this},this.refreshView=function(){let newOption=getInOption(instaceId),getEl=DPFNS.getLRSDPGElement,$pgel=getEl("pagination",$t).find(".page-nav"),$cs=getEl("count-select",$t);$cs&&$cs.html(newOption.makeCountSelection(newOption.dpParamKeys.count,newOption.currentViewValues.count,newOption.totalItemsCount,newOption.setCountsPerPage));let $sb=getEl("search-box",$t);$sb&&$sb.html(newOption.makeSearchBox(newOption));let $ph=getEl("property-head",$t);return $ph&&$ph.html(newOption.itemProperties.map((p=>newOption.makeItemPropertyLabel(p,newOption.indexedItemPropertiesKeys.indexOf(p.key)>-1,newOption.currentViewValues?.orderBy==p.key&&newOption.currentViewValues?.orderByIn))).join("")),""==newOption.getInfoURL?($pgel.html(paginationSection.paginationComponent(newOption)),paginationSection.setJumpToComponentView($t,newOption),addeventListners(instaceId,$t,newOption),loadPage(instaceId,$t,newOption)):(DPFNS.contentLoader($t,newOption,!0),$.ajax({url:newOption.getInfoURL,headers:newOption.httpRequestHeaders,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:makeLoadRequestParams(newOption),dataType:"json",success:function(resp){$.extend(!0,newOption,resp),newOption=DPFNS.functionNametoFunction(newOption),newOption=DPFNS.setOptionFromVars(newOption),setInOption(instaceId,newOption),$pgel.html(paginationSection.paginationComponent(newOption)),paginationSection.setJumpToComponentView($t,newOption),addeventListners(instaceId,$t,newOption),loadPage(instaceId,$t,newOption)},error:function(e){console.log("Unable to fetch the data from getInfoURL:"+newOption.getInfoURL)}})),this},this.instaceId=instaceId,this}})(jQuery);